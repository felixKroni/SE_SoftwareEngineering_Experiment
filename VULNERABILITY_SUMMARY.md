# Vulnerability Summary for SAST Evaluation

## Overview
This document provides a quick reference for all intentional vulnerabilities included in the Book Management System for SAST tool evaluation.

## Vulnerability Count by Category

### True Positives (TP): 16 vulnerabilities
Real security issues that SAST tools should detect.

### False Positives (FP): 0-2 potential
Safe code that might be incorrectly flagged by overly aggressive tools.

### False Negatives (FN): 1-2 potential
Subtle vulnerabilities that some tools might miss.

### True Negatives (TN): 15+ instances
Secure code that should not trigger alerts.

---

## Backend Vulnerabilities (Java - Spring Boot)

| # | Vulnerability Type | Severity | Location | Expected Detection |
|---|-------------------|----------|----------|-------------------|
| 1 | SQL Injection | Critical | BookController.java:67 (searchBooks) | TRUE POSITIVE |
| 2 | Hardcoded Credentials | High | BookController.java:61-63 | TRUE POSITIVE |
| 3 | Path Traversal | Critical | BookController.java:84 (exportBook) | TRUE POSITIVE |
| 4 | Information Disclosure | Medium | BookController.java:87 (catch block) | TRUE POSITIVE |
| 5 | Command Injection | Critical | BookController.java:96 (backupDatabase) | TRUE POSITIVE |
| 6 | Insecure Deserialization | Critical | BookController.java:108 (importBooks) | TRUE POSITIVE |
| 7 | XML External Entity (XXE) | High | BookController.java:119 (uploadXml) | TRUE POSITIVE |
| 8 | Weak Cryptography | Medium | BookController.java:133 (encryptText) | TRUE POSITIVE |
| 9 | Cross-Site Scripting | High | BookController.java:146 (getMessage) | TRUE POSITIVE |
| 10 | Insecure Random | Medium | BookController.java:154 (generateToken) | TRUE POSITIVE |
| 11 | Race Condition | Medium | BookController.java:163 (incrementCounter) | TRUE POSITIVE |
| 12 | Overly Permissive CORS | Low | BookController.java:15 (@CrossOrigin) | TRUE POSITIVE |
| 13 | Format String | Low | BookController.java:175 (getStatistics) | POTENTIAL FALSE NEGATIVE |

## Frontend Vulnerabilities (TypeScript/Angular)

| # | Vulnerability Type | Severity | Location | Expected Detection |
|---|-------------------|----------|----------|-------------------|
| 14 | Missing Input Validation | Medium | book.service.ts:37 (searchBooks) | TRUE POSITIVE |
| 15 | Path Traversal Risk | High | book.service.ts:43 (exportBook) | TRUE POSITIVE |
| 16 | Command Injection Risk | Critical | book.service.ts:49 (backupDatabase) | TRUE POSITIVE |
| 17 | No Format Validation | Low | book-form.component.html:26 (ISBN) | TRUE POSITIVE |
| 18 | No Range Validation | Low | book-form.component.html:36 (Price) | TRUE POSITIVE |
| 19 | No Length Limit | Low | book-form.component.html:53 (Description) | TRUE POSITIVE |

---

## Safe Code Instances (True Negatives)

### Backend Safe Code
- BookController.java: getAllBooks() - line 28
- BookController.java: getBookById() - line 33
- BookController.java: createBook() - line 39
- BookController.java: updateBook() - line 45
- BookController.java: deleteBook() - line 53
- BookService.java: All methods (lines 14-42)
- Book.java: Entity definition (safe data model)
- BookRepository.java: JPA repository (parameterized queries)

### Frontend Safe Code
- book-list.component.html: {{ book.title }} - Angular sanitizes automatically
- book-list.component.ts: All component methods
- BookService standard CRUD operations (lines 14-34)
- Book model interface (type-safe)

---

## Potential False Positives

### 1. BookRepository.java
**Line 14**: Native query with LIKE operator
```java
@Query(value = "SELECT * FROM books WHERE title LIKE %?1%", nativeQuery = true)
```
**Why Safe**: Uses parameterized query with ?1 placeholder, not string concatenation
**Risk**: Some tools might flag any native query as suspicious

### 2. BookService.ts
**Line 10**: Hardcoded URL
```typescript
private apiUrl = 'http://localhost:8080/api/books';
```
**Why Safe**: Standard practice for development configuration
**Risk**: Tools might flag hardcoded URLs as security issues

---

## SAST Tool Evaluation Metrics

### Calculation Formulas

**True Positive Rate (Recall/Sensitivity)**
```
TPR = TP / (TP + FN)
```
Expected: 16 out of 16 = 100% (ideal tool)

**False Positive Rate**
```
FPR = FP / (FP + TN)
```
Expected: 0-2 out of 17 = 0-12% (acceptable range)

**Precision (Positive Predictive Value)**
```
Precision = TP / (TP + FP)
```
Expected: 16 / (16 + 0-2) = 89-100%

**F1 Score (Harmonic Mean)**
```
F1 = 2 * (Precision * Recall) / (Precision + Recall)
```
Expected: > 90% for effective tools

**Accuracy**
```
Accuracy = (TP + TN) / (TP + TN + FP + FN)
```
Expected: > 95% for high-quality tools

---

## Testing Procedure

1. **Run SAST Tool** on both backend and frontend code
2. **Collect Results** from tool output
3. **Classify Findings**:
   - True Positives: Tool found real vulnerability from list
   - False Positives: Tool flagged safe code as vulnerable
   - False Negatives: Tool missed known vulnerability
   - True Negatives: Tool correctly ignored safe code

4. **Calculate Metrics** using formulas above
5. **Compare Tools** based on F1 score and accuracy

---

## Vulnerability Severity Distribution

- **Critical**: 5 vulnerabilities (SQL Injection, Path Traversal x2, Command Injection x2, Deserialization)
- **High**: 4 vulnerabilities (Hardcoded Credentials, XXE, XSS, Path Traversal Risk)
- **Medium**: 5 vulnerabilities (Info Disclosure, Weak Crypto, Insecure Random, Race Condition, Missing Validation x2)
- **Low**: 5 vulnerabilities (CORS, Format String, Form Validations x3)

---

## Expected Tool Behavior

### Excellent SAST Tool (Grade A)
- Detects: 15-16 True Positives
- False Positives: 0-1
- F1 Score: > 95%

### Good SAST Tool (Grade B)
- Detects: 12-14 True Positives
- False Positives: 1-2
- F1 Score: 85-95%

### Acceptable SAST Tool (Grade C)
- Detects: 9-11 True Positives
- False Positives: 2-3
- F1 Score: 70-85%

### Poor SAST Tool (Grade D/F)
- Detects: < 9 True Positives
- False Positives: > 3
- F1 Score: < 70%

---

## Notes for Evaluators

1. **Context Matters**: Some vulnerabilities (like hardcoded localhost URLs) are acceptable in development but not production
2. **Tool Configuration**: Results may vary based on tool sensitivity settings
3. **Language Support**: Ensure tool supports both Java and TypeScript/Angular
4. **Framework Awareness**: Tools should understand Spring Boot and Angular security contexts
5. **Documentation**: Check if tool provides clear remediation guidance

---

## Last Updated
January 9, 2026
