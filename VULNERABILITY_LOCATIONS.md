# Vulnerability Location Reference

This document provides exact file paths and line numbers for all vulnerabilities in the application.

## Backend Vulnerabilities

### File: backend/SE_Experiment_Backend/src/main/java/org/example/controller/BookController.java

| Line(s) | Vulnerability | Type | Category |
|---------|---------------|------|----------|
| 15 | `@CrossOrigin(origins = "*")` | Overly Permissive CORS | TRUE POSITIVE |
| 61-63 | Hardcoded database credentials | Hardcoded Credentials | TRUE POSITIVE |
| 67 | SQL Injection via string concatenation | SQL Injection | TRUE POSITIVE |
| 84 | Path traversal in file reading | Path Traversal | TRUE POSITIVE |
| 87 | Stack trace exposure in error message | Information Disclosure | TRUE POSITIVE |
| 96 | Command injection via Runtime.exec() | Command Injection | TRUE POSITIVE |
| 108 | Unsafe deserialization with ObjectInputStream | Insecure Deserialization | TRUE POSITIVE |
| 119-125 | XXE vulnerability (missing entity restriction) | XML External Entity | TRUE POSITIVE |
| 133 | Weak DES encryption | Weak Cryptography | TRUE POSITIVE |
| 146 | XSS via unescaped HTML output | Cross-Site Scripting | TRUE POSITIVE |
| 154-156 | Insecure Random for token generation | Insecure Random | TRUE POSITIVE |
| 161-165 | Non-thread-safe counter increment | Race Condition | TRUE POSITIVE |
| 175 | String.format with potential user input | Format String (subtle) | POTENTIAL FALSE NEGATIVE |

### File: backend/SE_Experiment_Backend/src/main/java/org/example/repository/BookRepository.java

| Line(s) | Vulnerability | Type | Category |
|---------|---------------|------|----------|
| 14-15 | Native query (but uses parameters correctly) | N/A | POTENTIAL FALSE POSITIVE |

### File: backend/SE_Experiment_Backend/src/main/java/org/example/service/BookService.java

| Line(s) | Code | Type | Category |
|---------|------|------|----------|
| 14-42 | All service methods | Safe Code | TRUE NEGATIVE |

### File: backend/SE_Experiment_Backend/src/main/java/org/example/model/Book.java

| Line(s) | Code | Type | Category |
|---------|------|------|----------|
| 1-19 | Entity definition | Safe Code | TRUE NEGATIVE |

## Frontend Vulnerabilities

### File: frontend/SE_Experiment_Frontend/src/app/services/book.service.ts

| Line(s) | Vulnerability | Type | Category |
|---------|---------------|------|----------|
| 10 | Hardcoded API URL | Hardcoded URL | POTENTIAL FALSE POSITIVE |
| 37-40 | No input sanitization for search query | Missing Input Validation | TRUE POSITIVE |
| 43-46 | Filename parameter without validation | Path Traversal Risk | TRUE POSITIVE |
| 49-51 | Path parameter without validation | Command Injection Risk | TRUE POSITIVE |

### File: frontend/SE_Experiment_Frontend/src/app/components/book-form/book-form.component.ts

| Line(s) | Vulnerability | Type | Category |
|---------|---------------|------|----------|
| 36-46 | No input validation before submission | Missing Validation | TRUE POSITIVE |

### File: frontend/SE_Experiment_Frontend/src/app/components/book-form/book-form.component.html

| Line(s) | Vulnerability | Type | Category |
|---------|---------------|------|----------|
| 26-32 | ISBN field without format validation | Missing Format Validation | TRUE POSITIVE |
| 36-44 | Price field allows negative numbers | Missing Range Validation | TRUE POSITIVE |
| 53-60 | Description field without length limit | Missing Length Validation | TRUE POSITIVE |

### File: frontend/SE_Experiment_Frontend/src/app/components/book-list/book-list.component.html

| Line(s) | Code | Type | Category |
|---------|------|------|----------|
| 22-24 | Angular template interpolation `{{ book.title }}` | Auto-sanitized | TRUE NEGATIVE |

### File: frontend/SE_Experiment_Frontend/src/app/components/book-list/book-list.component.ts

| Line(s) | Code | Type | Category |
|---------|------|------|----------|
| 1-37 | All component methods | Safe Code | TRUE NEGATIVE |

## Summary Statistics

### Backend (Java)
- **Vulnerable Files**: 1 (BookController.java)
- **Safe Files**: 3 (BookService.java, Book.java, Main.java)
- **Total Vulnerabilities**: 13 (12 definite + 1 subtle)
- **Potential False Positives**: 1 (BookRepository.java)

### Frontend (TypeScript/Angular)
- **Vulnerable Files**: 2 (book.service.ts, book-form.component.*)
- **Safe Files**: 2 (book-list.component.*, book.model.ts)
- **Total Vulnerabilities**: 6
- **Potential False Positives**: 1 (hardcoded localhost URL)

### Grand Total
- **Total True Positive Vulnerabilities**: 19
- **Total False Positive Candidates**: 2
- **Total True Negative Examples**: 15+
- **Total False Negative Candidates**: 1

## Vulnerability Severity Breakdown

### Critical (5)
1. SQL Injection (BookController.java:67)
2. Path Traversal (BookController.java:84)
3. Command Injection (BookController.java:96)
4. Insecure Deserialization (BookController.java:108)
5. Command Injection Risk (book.service.ts:49)

### High (4)
1. Hardcoded Credentials (BookController.java:61)
2. XXE (BookController.java:119)
3. XSS (BookController.java:146)
4. Path Traversal Risk (book.service.ts:43)

### Medium (6)
1. Information Disclosure (BookController.java:87)
2. Weak Cryptography (BookController.java:133)
3. Insecure Random (BookController.java:154)
4. Race Condition (BookController.java:161)
5. Missing Input Validation (book.service.ts:37)
6. Missing Validation (book-form.component.ts:36)

### Low (4)
1. Overly Permissive CORS (BookController.java:15)
2. Format String (BookController.java:175)
3. Missing Format Validation (book-form.component.html:26)
4. Missing Range/Length Validation (book-form.component.html:36,53)

## Testing Checklist

When running a SAST tool, verify it:

- [ ] Detects SQL Injection on line 67 of BookController.java
- [ ] Detects hardcoded credentials on lines 61-63
- [ ] Detects path traversal on line 84
- [ ] Detects command injection on line 96
- [ ] Detects insecure deserialization on line 108
- [ ] Detects XXE on line 119
- [ ] Detects weak crypto on line 133
- [ ] Detects XSS on line 146
- [ ] Detects insecure random on line 154
- [ ] Detects race condition on line 161
- [ ] Detects CORS misconfiguration on line 15
- [ ] Detects frontend validation issues
- [ ] Does NOT flag safe JPA queries as SQL injection
- [ ] Does NOT flag localhost URLs in dev config
- [ ] Provides accurate severity ratings
- [ ] Includes remediation advice

## Notes for Manual Review

1. **BookRepository.java line 14**: Uses native query but properly parameterized with `?1` - should NOT be flagged
2. **book.service.ts line 10**: Localhost URL is appropriate for development - may be flagged but is low priority
3. **BookController.java line 175**: Subtle format string issue may be missed by some tools
4. All CRUD operations in BookController should be marked as safe
5. Angular's automatic sanitization prevents XSS in templates

---

**Last Updated**: January 9, 2026
**Version**: 1.0
